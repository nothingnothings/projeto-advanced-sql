



Level: Difficult to very difficult

Topic: Correlated subquery

Task: Create a list of movies - with their
length and their replacement cost - that are longer than the average length in each replacement cost group.

Question: Which two movies are the shortest on that list and how long are they?




QUERY:


SELECT
title,
length,
replacement_cost
FROM film AS f1
WHERE length > (
	SELECT 
	AVG(length)
	FROM film AS f2 
	WHERE f1.replacement_cost = f2.replacement_cost
)
ORDER BY length DESC;




OUTPUT:





"title"	"length"	"replacement_cost"
"DARN FORRESTER"	185	14.99
"CONTROL ANTHEM"	185	9.99
"SWEET BROTHERHOOD"	185	27.99
"MUSCLE BRIGHT"	185	23.99
"GANGS PRIDE"	185	27.99
"WORST BANGER"	185	26.99
"POND SEATTLE"	185	25.99
"HOME PITY"	185	15.99
"SOLDIERS EVOLUTION"	185	27.99
"CHICAGO NORTH"	185	11.99
"SONS INTERVIEW"	184	11.99
"CONSPIRACY SPIRIT"	184	27.99
"SMOOCHY CONTROL"	184	18.99
"THEORY MERMAID"	184	9.99
"SORORITY QUEEN"	184	17.99
"MOONWALKER FOOL"	184	12.99
"CRYSTAL BREAKING"	184	22.99
"KING EVOLUTION"	184	24.99
"WIFE TURN"	183	27.99
"YOUNG LANGUAGE"	183	9.99
"CATCH AMISTAD"	183	10.99
"FRONTIER CABIN"	183	14.99
"SCALAWAG DUCK"	183	13.99
"MONSOON CAUSE"	182	20.99
"REDS POCUS"	182	23.99
"BAKED CLEOPATRA"	182	20.99
"SEARCHERS WAIT"	182	22.99
"RECORDS ZORRO"	182	11.99
"SATURN NAME"	182	18.99
"ANALYZE HOOSIERS"	181	19.99
"HAUNTING PIANIST"	181	22.99
"WILD APOLLO"	181	24.99
"HOTEL HAPPINESS"	181	28.99
"INTRIGUE WORST"	181	10.99
"JACKET FRISCO"	181	16.99
"LAWLESS VISION"	181	29.99
"LOVE SUICIDES"	181	21.99
"STAR OPERATION"	181	9.99
"RUNAWAY TENENBAUMS"	181	17.99
"SOMETHING DUCK"	180	17.99
"CONFIDENTIAL INTERVIEW"	180	13.99
"MIXED DOORS"	180	26.99
"ALLEY EVOLUTION"	180	23.99
"IMPACT ALADDIN"	180	20.99
"MUSSOLINI SPOILERS"	180	10.99
"NASH CHOCOLAT"	180	21.99
"CAUSE DATE"	179	16.99
"SLACKER LIAISONS"	179	29.99
"YOUTH KICK"	179	14.99
"ANONYMOUS HUMAN"	179	12.99
"FLIGHT LIES"	179	22.99
"REDEMPTION COMFORTS"	179	20.99
"POTLUCK MIXED"	179	10.99
"BORN SPINAL"	179	17.99
"TEXAS WATCH"	179	22.99
"TORQUE BOUND"	179	27.99
"KICK SAVANNAH"	179	10.99
"CASUALTIES ENCINO"	179	16.99
"VIRGIN DAISY"	179	29.99
"IMAGE PRINCESS"	178	17.99
"WRONG BEHAVIOR"	178	10.99
"WARDROBE PHANTOM"	178	19.99
"ROCKETEER MOTHER"	178	27.99
"NAME DETECTIVE"	178	11.99
"MADNESS ATTACKS"	178	14.99
"DROP WATERFRONT"	178	20.99
"INNOCENT USUAL"	178	26.99
"FURY MURDER"	178	28.99
"EXPRESS LONELY"	178	23.99
"DOZEN LION"	177	20.99
"DOUBLE WRATH"	177	28.99
"MANCHURIAN CURTAIN"	177	27.99
"QUEST MUSSOLINI"	177	29.99
"RIDER CADDYSHACK"	177	28.99
"EMPIRE MALKOVICH"	177	26.99
"DRACULA CRYSTAL"	176	26.99
"CAPER MOTIONS"	176	22.99
"GREEK EVERYONE"	176	11.99
"HOOSIERS BIRDCAGE"	176	12.99
"WRATH MILE"	176	17.99
"ENTRAPMENT SATISFACTION"	176	19.99
"SWEDEN SHINING"	176	19.99
"BRAVEHEART HUMAN"	176	14.99
"GATHERING CALENDAR"	176	22.99
"CYCLONE FAMILY"	176	18.99
"BEAUTY GREASE"	175	28.99
"SPLASH GUMP"	175	16.99
"PATTON INTERVIEW"	175	22.99
"DRIVING POLISH"	175	21.99
"MODEL FISH"	175	11.99
"LAWRENCE LOVE"	175	23.99
"EVOLUTION ALTER"	174	10.99
"ITALIAN AFRICAN"	174	24.99
"LIGHTS DEER"	174	21.99
"UPRISING UPTOWN"	174	16.99
"JADE BUNCH"	174	21.99
"VIETNAM SMOOCHY"	174	27.99
"GLADIATOR WESTWARD"	173	20.99
"CONQUERER NUTS"	173	14.99
"TALENTED HOMICIDE"	173	9.99
"FIRE WOLVES"	173	18.99
"BALLROOM MOCKINGBIRD"	173	29.99
"VELVET TERMINATOR"	173	14.99
"PIZZA JUMANJI"	173	11.99
"CONNECTICUT TRAMP"	172	20.99
"UNCUT SUICIDES"	172	29.99
"JERK PAYCHECK"	172	13.99
"CREEPERS KANE"	172	23.99
"TIGHTS DAWN"	172	14.99
"NORTHWEST POLISH"	172	24.99
"IDAHO LOVE"	172	25.99
"EYES DRIVING"	172	13.99
"TRAMP OTHERS"	171	27.99
"MAGNOLIA FORRESTER"	171	28.99
"KRAMER CHOCOLATE"	171	24.99
"WORLD LEATHERNECKS"	171	13.99
"JERICHO MULAN"	171	29.99
"ROXANNE REBEL"	171	9.99
"MOONSHINE CABIN"	171	25.99
"DUFFEL APOCALYPSE"	171	13.99
"TRADING PINOCCHIO"	170	22.99
"DRAGON SQUAD"	170	26.99
"ATLANTIS CAUSE"	170	15.99
"ARTIST COLDBLOODED"	170	10.99
"AGENT TRUMAN"	169	17.99
"OUTBREAK DIVINE"	169	12.99
"HEDWIG ALTER"	169	16.99
"SOUP WISDOM"	169	12.99
"KENTUCKIAN GIANT"	169	10.99
"BREAKING HOME"	169	21.99
"DYING MAKER"	168	28.99
"ANTITRUST TOMATOES"	168	11.99
"HAROLD FRENCH"	168	10.99
"TRANSLATION SUMMER"	168	10.99
"REQUIEM TYCOON"	167	25.99
"SHOW LORD"	167	24.99
"INCH JET"	167	18.99
"ESCAPE METROPOLIS"	167	20.99
"EXORCIST STING"	167	17.99
"CAMPUS REMEMBER"	167	27.99
"LESSON CLEOPATRA"	167	28.99
"CONTACT ANONYMOUS"	166	10.99
"GREEDY ROOTS"	166	14.99
"MURDER ANTITRUST"	166	11.99
"MOTIONS DETAILS"	166	16.99
"MINE TITANS"	166	12.99
"CITIZEN SHREK"	165	18.99
"DARLING BREAKING"	165	20.99
"MASSACRE USUAL"	165	16.99
"SONG HEDWIG"	165	29.99
"SPEAKEASY DATE"	165	22.99
"MISSION ZOOLANDER"	164	26.99
"UNITED PILOT"	164	27.99
"CLERKS ANGELS"	164	15.99
"VIRGINIAN PLUTO"	164	22.99
"KISS GLORY"	163	11.99
"EVERYONE CRAFT"	163	29.99
"STORY SIDE"	163	27.99
"CASPER DRAGONFLY"	163	16.99
"BIRD INDEPENDENCE"	163	14.99
"QUEEN LUKE"	163	22.99
"GILMORE BOILED"	163	29.99
"LOVERBOY ATTACKS"	162	19.99
"BIRCH ANTITRUST"	162	18.99
"MIRACLE VIRTUAL"	162	19.99
"BADMAN DAWN"	162	22.99
"ROSES TREASURE"	162	23.99
"BROOKLYN DESERT"	161	21.99
"NEIGHBORS CHARADE"	161	20.99
"OLEANDER CLUE"	161	12.99
"METAL ARMAGEDDON"	161	26.99
"WASH HEAVENLY"	161	22.99
"DADDY PITTSBURGH"	161	26.99
"MASSAGE IMAGE"	161	11.99
"KILLER INNOCENT"	161	11.99
"GABLES METROPOLIS"	161	17.99
"MULAN MOON"	160	10.99
"MUMMY CREATURES"	160	15.99
"IGBY MAKER"	160	12.99
"PEACH INNOCENT"	160	20.99
"STOCK GLASS"	160	10.99
"BEAR GRACELAND"	160	20.99
"NEWSIES STORY"	159	25.99
"DRIVER ANNIE"	159	11.99
"WEST LION"	159	29.99
"FRANKENSTEIN STRANGER"	159	16.99
"MALKOVICH PET"	159	22.99
"POSEIDON FOREVER"	159	29.99
"ROAD ROXANNE"	158	12.99
"FOOL MOCKINGBIRD"	158	24.99
"MONTEREY LABYRINTH"	158	13.99
"FEVER EMPIRE"	158	20.99
"SECRETARY ROUGE"	158	10.99
"ENOUGH RAGING"	158	16.99
"VOLCANO TEXAS"	157	27.99
"MULHOLLAND BEAST"	157	13.99
"HOBBIT ALIEN"	157	27.99
"INDEPENDENCE HOTEL"	157	21.99
"PAST SUICIDES"	157	17.99
"TOOTSIE PILOT"	157	10.99
"SLIPPER FIDELITY"	156	14.99
"OPERATION OPERATION"	156	23.99
"FINDING ANACONDA"	156	10.99
"GRADUATE LORD"	156	14.99
"LOLITA WORLD"	155	25.99
"ELF MURDER"	155	19.99
"TADPOLE PARK"	155	13.99
"PSYCHO SHRUNK"	155	11.99
"GRAPES FURY"	155	20.99
"FAMILY SWEET"	155	24.99
"RAGING AIRPLANE"	154	18.99
"GOLD RIVER"	154	21.99
"SHREK LICENSE"	154	15.99
"SASSY PACKER"	154	29.99
"SANTA PARIS"	154	23.99
"DURHAM PANKY"	154	14.99
"DOUBTFIRE LABYRINTH"	154	16.99
"CROSSROADS CASUALTIES"	153	20.99
"APOLLO TEEN"	153	15.99
"RIGHT CRANES"	153	29.99
"GOLDMINE TYCOON"	153	20.99
"EDGE KISSING"	153	9.99
"LEATHERNECKS DWARFS"	153	21.99
"BABY HALL"	153	23.99
"ROLLERCOASTER BRINGING"	153	13.99
"RULES HUMAN"	153	19.99
"TELEMARK HEARTBREAKERS"	152	9.99
"SISTER FREDDY"	152	19.99
"ELIZABETH SHANE"	152	11.99
"LUCK OPUS"	152	21.99
"CENTER DINOSAUR"	152	12.99
"TOURIST PELICAN"	152	18.99
"TUXEDO MILE"	152	24.99
"WAGON JAWS"	152	17.99
"TWISTED PIRATES"	152	23.99
"SCHOOL JACKET"	151	21.99
"SPOILERS HELLFIGHTERS"	151	26.99
"MASKED BUBBLE"	151	12.99
"BEETHOVEN EXORCIST"	151	26.99
"STRAIGHT HOURS"	151	19.99
"CAROL TEXAS"	151	15.99
"HUNCHBACK IMPOSSIBLE"	151	28.99
"HYSTERICAL GRAIL"	150	19.99
"ALI FOREVER"	150	21.99
"CLEOPATRA DEVIL"	150	26.99
"BINGO TALENTED"	150	22.99
"RUSHMORE MERMAID"	150	17.99
"SATURDAY LAMBS"	150	28.99
"CHRISTMAS MOONSHINE"	150	21.99
"GRINCH MASSAGE"	150	25.99
"COLOR PHILADELPHIA"	149	19.99
"MINDS TRUMAN"	149	22.99
"NIGHTMARE CHILL"	149	25.99
"RIVER OUTLAW"	149	29.99
"SPIRIT FLINTSTONES"	149	23.99
"HOLOCAUST HIGHBALL"	149	12.99
"FLINTSTONES HAPPINESS"	148	11.99
"OUTLAW HANKY"	148	17.99
"ARMY FLINTSTONES"	148	22.99
"BLANKET BEVERLY"	148	21.99
"FIREBALL PHILADELPHIA"	148	25.99
"TELEGRAPH VOYAGE"	148	20.99
"EASY GLADIATOR"	148	12.99
"MENAGERIE RUSHMORE"	147	18.99
"ARACHNOPHOBIA ROLLERCOASTER"	147	24.99
"SCISSORHANDS SLUMS"	147	13.99
"LIES TREATMENT"	147	28.99
"RANGE MOONWALKER"	147	25.99
"MADISON TRAP"	147	11.99
"RACER EGG"	147	19.99
"DIRTY ACE"	147	29.99
"SLUMS DUCK"	147	21.99
"COWBOY DOOM"	146	10.99
"HALF OUTFIELD"	146	25.99
"CHAPLIN LICENSE"	146	26.99
"HAMLET WISDOM"	146	21.99
"MOURNING PURPLE"	146	14.99
"NUTS TIES"	145	10.99
"FLOATS GARDEN"	145	29.99
"VIDEOTAPE ARSENIC"	145	10.99
"VACATION BOONDOCK"	145	23.99
"PAYCHECK WAIT"	145	27.99
"ROCKY WAR"	145	17.99
"RUN PACIFIC"	145	25.99
"LAMBS CINCINATTI"	144	18.99
"FACTORY DRAGON"	144	9.99
"DANCING FEVER"	144	25.99
"PACIFIC AMISTAD"	144	27.99
"PRESIDENT BANG"	144	12.99
"STRICTLY SCARFACE"	144	24.99
"TOWERS HURRICANE"	144	14.99
"VIRTUAL SPOILERS"	144	14.99
"DETECTIVE VISION"	143	16.99
"STEEL SANTA"	143	15.99
"CROOKED FROGMEN"	143	27.99
"ENCINO ELF"	143	9.99
"CLOCKWORK PARADISE"	143	29.99
"CINCINATTI WHISPERER"	143	26.99
"SOUTH WAIT"	143	21.99
"CHILL LUCK"	142	17.99
"VANISHED GARDEN"	142	17.99
"FERRIS MOTHER"	142	13.99
"MILLION ACE"	142	16.99
"BIKINI BORROWERS"	142	26.99
"TRACY CIDER"	142	29.99
"TOMORROW HUSTLER"	142	21.99
"SPICE SORORITY"	141	22.99
"HOMICIDE PEACH"	141	21.99
"DYNAMITE TARZAN"	141	27.99
"DISCIPLE MOTHER"	141	17.99
"KISSING DOLLS"	141	9.99
"SUN CONFESSIONS"	141	9.99
"HOCUS FRIDA"	141	19.99
"LOATHING LEGALLY"	140	29.99
"GRACELAND DYNAMITE"	140	26.99
"STEERS ARMAGEDDON"	140	16.99
"EAGLES PANKY"	140	14.99
"LIAISONS SWEET"	140	15.99
"CLYDE THEORY"	139	29.99
"VOICE PEACH"	139	22.99
"CREATURES SHAKESPEARE"	139	23.99
"HOPE TOOTSIE"	139	22.99
"SHRUNK DIVINE"	139	14.99
"DORADO NOTTING"	139	26.99
"TRAFFIC HOBBIT"	139	13.99
"STRANGER STRANGERS"	139	12.99
"WORKER TARZAN"	139	26.99
"GROUNDHOG UNCUT"	139	26.99
"HORROR REIGN"	139	25.99
"EXPECATIONS NATURAL"	138	26.99
"POCUS PULP"	138	15.99
"MAIDEN HOME"	138	9.99
"LIBERTY MAGNIFICENT"	138	27.99
"SPIRITED CASUALTIES"	138	20.99
"SPINAL ROCKY"	138	12.99
"LOSE INCH"	137	18.99
"PHILADELPHIA WIFE"	137	16.99
"POLLOCK DELIVERANCE"	137	14.99
"LIFE TWISTED"	137	9.99
"SCORPION APOLLO"	137	23.99
"SLEEPY JAPANESE"	137	25.99
"GRIT CLOCKWORK"	137	21.99
"ARSENIC INDEPENDENCE"	137	17.99
"WILLOW TRACY"	137	22.99
"REAP UNFAITHFUL"	136	26.99
"TOWN ARK"	136	17.99
"HOLLOW JEOPARDY"	136	25.99
"SQUAD FISH"	136	14.99
"PIANIST OUTFIELD"	136	25.99
"CRAZY HOME"	136	24.99
"BRINGING HYSTERICAL"	136	14.99
"ALASKA PHANTOM"	136	22.99
"MAKER GABLES"	136	12.99
"DREAM PICKUP"	135	18.99
"CANDLES GRAPES"	135	15.99
"INDIAN LOVE"	135	26.99
"SUNRISE LEAGUE"	135	19.99
"GREASE YOUTH"	135	20.99
"MONEY HAROLD"	135	17.99
"THIEF PELICAN"	135	28.99
"JAPANESE RUN"	135	29.99
"SIERRA DIVIDE"	135	12.99
"WALLS ARTIST"	135	19.99
"SPLENDOR PATTON"	134	20.99
"JUNGLE CLOSER"	134	11.99
"ROBBERY BRIGHT"	134	21.99
"WEEKEND PERSONAL"	134	26.99
"PITTSBURGH HUNCHBACK"	134	17.99
"CURTAIN VIDEOTAPE"	133	27.99
"DRAGONFLY STRANGERS"	133	19.99
"FREEDOM CLEOPATRA"	133	23.99
"BUCKET BROTHERHOOD"	133	27.99
"MALLRATS UNITED"	133	25.99
"TRAINSPOTTING STRANGERS"	132	10.99
"NECKLACE OUTBREAK"	132	21.99
"VOLUME HOUSE"	132	12.99
"CHOCOLATE DUCK"	132	13.99
"DUDE BLINDNESS"	132	9.99
"PLATOON INSTINCT"	132	10.99
"SKY MIRACLE"	132	15.99
"STREAK RIDGEMONT"	132	28.99
"FOREVER CANDIDATE"	131	28.99
"OPEN AFRICAN"	131	16.99
"ICE CROSSING"	131	28.99
"NEMO CAMPUS"	131	23.99
"FANTASIA PARK"	131	29.99
"DARKO DORADO"	130	13.99
"FARGO GANDHI"	130	28.99
"AFRICAN EGG"	130	22.99
"MAJESTIC FLOATS"	130	15.99
"STALLION SUNDANCE"	130	23.99
"JASON TRAP"	130	9.99
"SLEEPING SUSPECTS"	129	13.99
"MUSIC BOONDOCK"	129	17.99
"AMERICAN CIRCUS"	129	17.99
"GOSFORD DONNIE"	129	17.99
"BAREFOOT MANCHURIAN"	129	15.99
"UNFORGIVEN ZOOLANDER"	129	15.99
"OUTFIELD MASSACRE"	129	18.99
"USUAL UNTOUCHABLES"	128	21.99
"JEDI BENEATH"	128	12.99
"PAPI NECKLACE"	128	9.99
"GALAXY SWEETHEARTS"	128	13.99
"HOLES BRANNIGAN"	128	27.99
"NOTORIOUS REUNION"	128	9.99
"WARS PLUTO"	128	15.99
"MALTESE HOPE"	127	26.99
"SUBMARINE BED"	127	21.99
"GUNFIGHTER MUSSOLINI"	127	9.99
"ARGONAUTS TOWN"	127	12.99
"SEVEN SWARM"	127	15.99
"VAMPIRE WHALE"	126	11.99
"MONTEZUMA COMMAND"	126	22.99
"ALAMO VIDEOTAPE"	126	16.99
"FREAKY POCUS"	126	16.99
"PAJAMA JAWBREAKER"	126	14.99
"ELEPHANT TROJAN"	126	24.99
"WONDERFUL DROP"	126	20.99
"WOMEN DORADO"	126	23.99
"SINNERS ATLANTIS"	126	19.99
"BULL SHAWSHANK"	125	21.99
"HUNTER ALTER"	125	21.99
"GENTLEMEN STAGE"	125	22.99
"SAINTS BRIDE"	125	11.99
"DONNIE ALLEY"	125	20.99
"FISH OPUS"	125	22.99
"SHINING ROSES"	125	12.99
"CLONES PINOCCHIO"	124	16.99
"CHISUM BEHAVIOR"	124	25.99
"SPEED SUIT"	124	19.99
"JINGLE SAGEBRUSH"	124	29.99
"VANISHING ROCKY"	123	21.99
"INSECTS STONE"	123	14.99
"SWARM GOLD"	123	12.99
"BREAKFAST GOLDFINGER"	123	18.99
"REEF SALUTE"	123	26.99
"MASK PEACH"	123	26.99
"FLASH WARS"	123	21.99
"MIGHTY LUCK"	122	13.99
"EXTRAORDINARY CONQUERER"	122	29.99
"VANILLA DAY"	122	20.99
"ILLUSION AMELIE"	122	15.99
"CONFUSED CANDLES"	122	27.99
"CHICKEN HELLFIGHTERS"	122	24.99
"DECEIVER BETRAYED"	122	22.99
"HOURS RAGE"	122	14.99
"BOOGIE AMELIE"	121	11.99
"PURE RUNNER"	121	25.99
"BRANNIGAN SUNRISE"	121	27.99
"JUMANJI BLADE"	121	13.99
"ARIZONA BANG"	121	28.99
"HARRY IDAHO"	121	18.99
"PARIS WEEKEND"	121	19.99
"ORDER BETRAYED"	120	13.99
"COMMAND DARLING"	120	28.99
"UNTOUCHABLES SUNRISE"	120	11.99
"KARATE MOON"	120	21.99
"DAZED PUNK"	120	20.99
"RAGE GAMES"	120	18.99
"DUMBO LUST"	119	17.99
"IDENTITY LOVER"	119	12.99
"BUGSY SONG"	119	17.99
"GAMES BOWFINGER"	119	17.99
"BACKLASH UNDEFEATED"	118	24.99
"PERSONAL LADYBUGS"	118	19.99
"JAWBREAKER BROOKLYN"	118	15.99
"PATHS CONTROL"	118	9.99
"OTHERS SOUP"	118	18.99
"RESURRECTION SILVERADO"	117	12.99
"GRAFFITI LOVE"	117	29.99
"MAGIC MALLRATS"	117	19.99
"WORDS HUNTER"	116	13.99
"MADIGAN DORADO"	116	20.99
"DUCK RACER"	116	15.99
"TROOPERS METAL"	115	20.99
"ELEMENT FREDDY"	115	28.99
"PRIX UNDEFEATED"	115	13.99
"GLORY TRACY"	115	13.99
"GILBERT PELICAN"	114	13.99
"LADYBUGS ARMAGEDDON"	113	13.99
"STATE WASTELAND"	113	13.99
"CONEHEADS SMOOCHY"	112	12.99
"QUILLS BULL"	112	19.99
"SPY MILE"	112	13.99
"GROOVE FICTION"	111	13.99
"WONDERLAND CHRISTMAS"	111	19.99
"SUIT WALLS"	111	12.99
"WIND PHANTOM"	111	12.99
"CELEBRITY HORN"	110	24.99
"SEATTLE EXPECATIONS"	110	18.99






Answer: CELEBRITY HORN and SEATTLE EXPECTATIONS with 110 minutes.












MINHA VERSAO:



SELECT
title,
length,
replacement_cost
FROM film AS f1
WHERE length > (
	SELECT 
	AVG(length)
	FROM film AS f2 
	WHERE f1.replacement_cost = f2.replacement_cost
)
ORDER BY length DESC;







VERSAO DO PROFESSOR:





SELECT
title,
length,
replacement_cost
FROM film AS f1
WHERE length > (
	SELECT 
	AVG(length)
	FROM film AS f2 
	WHERE f1.replacement_cost = f2.replacement_cost
)
ORDER BY length DESC;







